webpackJsonp([0],{18:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(35);t.default=new function(){var e,t=this,s={},i={},a=(0,n.readCookie)("session_id"),r=!1,o=!1;this.connect=function(){if(null==a)return void console.error("Could not find session_id cookie?!");if(!r){r=!0,console.log("Connecting...");var s=new WebSocket("wss://www.roiatalla.com/active-learning/api");s.onopen=function(){e=s,console.log("Connected to server!"),t.send("login",a,function(e,s){e?console.error("Failed to authenticate to API."):console.log("Successfully logged in."),o=!0,t.emit("login",s)})},s.onmessage=function(e){var s=JSON.parse(e.data);if(i[s.id]){var n=i[s.id];n.callback(s.err,s.data,n.request),delete i[s.id]}else s.event&&t.emit(s.event,s.data)},s.onclose=function(){e=null,o=!1,r=!1,console.log("Connection closed."),setTimeout(t.connect,1e3)}}},this.isSocketAvailable=function(){return null!=e||(alert("No connection to the server. Attemping to reconnect..."),t.connect(),!1)},this.isConnected=function(){return null!=e},this.isLoggedIn=function(){return o},this.on=function(e,t){s[e]=s[e]||[],s[e].push(t)},this.once=function(e,s){var n=function n(i){s(i),t.remove(e,n)};t.on(e,n)},this.remove=function(e,t){var n=s[e].indexOf(t);n>=0&&s[e].splice(n,1)},this.emit=function(e,t){s[e]&&s[e].forEach(function(e){return e(t)})};var u=0;this.send=function(s,n,a){if(!s)return a("Invalid command");if("function"==typeof n&&(a=n,n=void 0),t.isSocketAvailable()){var r={id:u++,command:s,data:n};e.send(JSON.stringify(r)),a&&"function"==typeof a&&(i[r.id]={request:r,callback:a})}else a&&"function"==typeof a&&a("Not connected")}}},231:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u=s(3),l=n(u),c=s(18),d=n(c),h=s(305),f=n(h),p=s(0),m=n(p),v=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={creatingQuiz:!1},s}return r(t,e),o(t,[{key:"setCreatingQuiz",value:function(e){this.state.creatingQuiz!=e&&this.setState({creatingQuiz:e})}},{key:"render",value:function(){return l.default.createElement("div",{id:"panels"},l.default.createElement(g,{user:this.props.user,selectedTerm:this.props.selectedTerm,questions:this.props.questions,quizzes:this.props.quizzes,setCreatingQuiz:this.setCreatingQuiz.bind(this),getResource:this.props.getResource,showConfirm:this.props.showConfirm}),l.default.createElement(w,{user:this.props.user,selectedTerm:this.props.selectedTerm,questions:this.props.questions,creatingQuiz:this.state.creatingQuiz,getResource:this.props.getResource,deleteResource:this.props.deleteResource,showConfirm:this.props.showConfirm}))}}]),t}(l.default.Component);t.default=v;var g=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={editQuiz:null},s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(function(t){if(t.editQuiz&&t.editQuiz._id)return{editQuiz:e.quizzes[t.editQuiz._id]||null}})}},{key:"setCreatingQuiz",value:function(){this.state.editQuiz&&this.state.editQuiz.is_published||this.props.setCreatingQuiz(!!this.state.editQuiz)}},{key:"chooseQuiz",value:function(e){this.setState({editQuiz:this.props.quizzes[e]},this.setCreatingQuiz.bind(this))}},{key:"toggleQuizEditor",value:function(){this.setState(function(e){return{editQuiz:e.editQuiz?null:{}}},this.setCreatingQuiz.bind(this))}},{key:"hideQuizEditor",value:function(){this.setState({editQuiz:null},this.setCreatingQuiz.bind(this))}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{id:"quiz-panel",className:"panel home-panel"},l.default.createElement("button",{className:"option-button",onClick:function(){return e.toggleQuizEditor()}},this.state.editQuiz?"Cancel":"Create Quiz"),this.state.editQuiz?l.default.createElement(b,{user:this.props.user,selectedTerm:this.props.selectedTerm,quiz:this.state.editQuiz,questions:this.props.questions,hideQuizEditor:this.hideQuizEditor.bind(this),getResource:this.props.getResource,showConfirm:this.props.showConfirm}):l.default.createElement(_,{showConfirm:this.props.showConfirm,quizzes:this.props.quizzes,chooseQuiz:this.chooseQuiz.bind(this)}))}}]),t}(l.default.Component),b=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=e.quiz.settings||{},r=(0,m.default)(),o=(0,m.default)();return s.state={_id:e.quiz._id,name:e.quiz.name||"",is_published:e.quiz.is_published||!1,is_live:e.quiz.is_live||!1,questions:e.quiz.questions||[],settings:{live_question:n.live_question,open_date:n.open_date||r.seconds(0).milliseconds(0).minutes(5*Math.floor(r.minutes()/5)).toDate(),close_date:n.close_date||o.seconds(0).milliseconds(0).minutes(5*Math.floor(o.minutes()/5)).days(o.days()+7).toDate(),max_submission:n.max_submission||0,allow_submission_review:n.allow_submission_review||!1,submission_review_after_close:!1!==n.submission_review_after_close,allow_score_review:n.allow_score_review||!1,score_review_after_close:!1!==n.score_review_after_close,allow_correct_review:n.allow_correct_review||!1,correct_review_after_close:!1!==n.correct_review_after_close}},s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(function(t){var s=(0,m.default)(),n=(0,m.default)(),i=e.quiz.settings||t.settings;return{_id:e.quiz._id,name:e.quiz.name||t.name,is_published:e.quiz.is_published||t.is_published,is_live:e.quiz.is_live||t.is_live,questions:e.quiz.questions||t.questions,settings:{live_question:i.live_question,open_date:i.open_date||s.seconds(0).milliseconds(0).minutes(5*Math.floor(s.minutes()/5)).toDate(),close_date:i.close_date||n.seconds(0).milliseconds(0).minutes(5*Math.floor(n.minutes()/5)).days(n.days()+7).toDate(),max_submission:i.max_submission||0,allow_submission_review:i.allow_submission_review||!1,submission_review_after_close:!1!==i.submission_review_after_close,allow_score_review:i.allow_score_review||!1,score_review_after_close:!1!==i.score_review_after_close,allow_correct_review:i.allow_correct_review||!1,correct_review_after_close:!1!==i.correct_review_after_close}}})}},{key:"onNameChange",value:function(e){this.setState({name:e.target.value})}},{key:"onOpenDateChange",value:function(e){if("string"==typeof e)var t=new Date(e);else var t=e.toDate();this.setState(function(e){var s={};return Object.assign(s,e.settings),s.open_date=t,{settings:s}})}},{key:"onCloseDateChange",value:function(e){if("string"==typeof e)var t=new Date(e);else var t=e.toDate();this.setState(function(e){var s={};return Object.assign(s,e.settings),s.close_date=t,{settings:s}})}},{key:"onMaxSubmissionChange",value:function(e){var t=Math.floor(Math.max(e.target.value,0));this.setState(function(e){var s={};return Object.assign(s,e.settings),s.max_submission=t,{settings:s}})}},{key:"submitQuiz",value:function(e){var t=this,s=function(e){e?t.props.showConfirm({type:"ok",title:"Error when submitting quiz: "+e}):t.props.hideQuizEditor()};if(!this.state.name.trim())return this.props.showConfirm({type:"ok",title:"Name is required"});this.state._id?d.default.send("updateQuiz",{_id:this.state._id,name:this.state.name,is_published:e,is_live:this.state.is_live,questions:this.state.questions,settings:this.state.settings},s):d.default.send("createQuiz",{name:this.state.name,is_published:e,is_live:this.state.is_live,questions:this.state.questions,settings:this.state.settings},s)}},{key:"removeQuestion",value:function(e){this.setState(function(t){var s=t.questions.slice(),n=s.indexOf(e);return-1!=n?(s.splice(n,1),{questions:s}):{}})}},{key:"presentLive",value:function(e){if(!this.state.is_published||!this.state.is_live)return console.error("Cannot present live.");var t=this.state.questions.indexOf(e);-1!=t&&d.default.send("updateLiveQuiz",{quiz_id:this.state._id,question_idx:t},function(e){e&&(console.error("Error when presenting live."),console.error(e))})}},{key:"onDragStart",value:function(e,t){t.dataTransfer.setData("question-id",e)}},{key:"getDropTargetId",value:function(e){for(var t=e.target;t&&(!t.dataset||!t.dataset.id);)t=t.parentNode;return t&&t.dataset.id}},{key:"onDrop",value:function(e){this.setState({dragOverId:null}),e.preventDefault();var t=e.dataTransfer.getData("question-id");if(t){var s=this.getDropTargetId(e);this.setState(function(e){var n=e.questions.slice();if(s){if(t!=s){var i=n.indexOf(t),a=n.indexOf(s);-1!=i&&n.splice(i,1),-1!=a?n.splice(a,0,t):n.push(t)}}else{var i=n.indexOf(t);-1!=i&&n.splice(i,1),n.push(t)}return{questions:n}})}}},{key:"onDragOver",value:function(e){e.preventDefault();var t=this.getDropTargetId(e);t!=this.state.dragOverId&&this.setState({dragOverId:t})}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{id:"quiz-creator"},!this.state.is_published&&l.default.createElement("div",{id:"save-publish-buttons"},l.default.createElement("button",{id:"save-quiz-button",onClick:this.submitQuiz.bind(this,!1)},"Save"),l.default.createElement("button",{id:"publish-quiz-buton",onClick:this.submitQuiz.bind(this,!0)},"Publish")),l.default.createElement("div",{id:"quiz-creator-header"},l.default.createElement("div",{id:"quiz-creator-table"},l.default.createElement("div",{className:"quiz-table-row"},l.default.createElement("div",{id:"quiz-name",className:"quiz-table-cell"},"Name: ",this.state.is_published?this.state.name:l.default.createElement("input",{type:"text",id:"quiz-name-field",value:this.state.name,onChange:this.onNameChange.bind(this)}))),l.default.createElement("div",{className:"quiz-table-row"},l.default.createElement("div",{className:"quiz-creator-header-entry quiz-table-cell"},"Open Date: ",this.state.is_published?this.state.settings.open_date:l.default.createElement(f.default,{value:this.state.settings.open_date,onChange:this.onOpenDateChange.bind(this),isValidDate:function(t){return t<e.state.settings.close_date},timeConstraints:{minutes:{step:5}}})),l.default.createElement("div",{className:"quiz-creator-header-entry quiz-table-cell"},"Close Date: ",this.state.is_published?this.state.settings.close_date:l.default.createElement(f.default,{value:this.state.settings.close_date,onChange:this.onCloseDateChange.bind(this),isValidDate:function(t){return t>e.state.settings.open_date},timeConstraints:{minutes:{step:5}}}))),l.default.createElement("div",{className:"quiz-table-row"},l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.is_live):l.default.createElement("input",{type:"checkbox",checked:this.state.is_live,onChange:function(){return e.setState(function(e){return{is_live:!e.is_live}})}}),"Live Quiz"),l.default.createElement("div",{className:"quiz-creator-header-entry quiz-table-cell"},l.default.createElement("div",null,"Submissions: ",this.state.is_published?this.state.settings.max_submission||"Unlimited":l.default.createElement("input",{type:"number",size:"2",value:this.state.settings.max_submission,onChange:this.onMaxSubmissionChange.bind(this)})),!this.state.is_published&&l.default.createElement("div",null,"0 for unlimited"))),l.default.createElement("div",{className:"quiz-table-row"},l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.settings.allow_submission_review):l.default.createElement("input",{type:"checkbox",checked:this.state.settings.allow_submission_review,onChange:function(t){return e.setState(function(e){var t=Object.assign({},e.settings);return t.allow_submission_review=!t.allow_submission_review,{settings:t}})}}),"Allow submission review"),l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.settings.submission_review_after_close):l.default.createElement("input",{type:"checkbox",checked:this.state.settings.submission_review_after_close,onChange:function(t){return e.setState(function(e){var t=Object.assign({},e.settings);return t.submission_review_after_close=!t.submission_review_after_close,{settings:t}})}}),"Release submissions after close")),l.default.createElement("div",{className:"quiz-table-row"},l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.settings.allow_score_review):l.default.createElement("input",{type:"checkbox",checked:this.state.settings.allow_score_review,onChange:function(t){return e.setState(function(e){var t=Object.assign({},e.settings);return t.allow_score_review=!t.allow_score_review,{settings:t}})}}),"Allow score review"),l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.settings.score_review_after_close):l.default.createElement("input",{type:"checkbox",checked:this.state.settings.score_review_after_close,onChange:function(t){return e.setState(function(e){var t=Object.assign({},e.settings);return t.score_review_after_close=!t.score_review_after_close,{settings:t}})}}),"Release scores after close")),l.default.createElement("div",{className:"quiz-table-row"},l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.settings.allow_correct_review):l.default.createElement("input",{type:"checkbox",checked:this.state.settings.allow_correct_review,onChange:function(t){return e.setState(function(e){var t=Object.assign({},e.settings);return t.allow_correct_review=!t.allow_correct_review,{settings:t}})}}),"Allow correct answer review"),l.default.createElement("div",{className:"quiz-table-cell"},this.state.is_published?String(this.state.settings.correct_review_after_close):l.default.createElement("input",{type:"checkbox",checked:this.state.settings.correct_review_after_close,onChange:function(t){return e.setState(function(e){var t=Object.assign({},e.settings);return t.correct_review_after_close=!t.correct_review_after_close,{settings:t}})}}),"Release correct answers after close")))),l.default.createElement("ol",{id:"quiz-question-list",onDrop:this.onDrop.bind(this),onDragOver:this.onDragOver.bind(this)},this.state.questions.length>0?[this.state.questions.map(function(t,s){return l.default.createElement(k,{key:t,question:e.props.questions[t],getResource:e.props.getResource,draggable:!e.state.is_published,onDragStart:e.onDragStart.bind(e,t),draggedOver:e.state.dragOverId==t},!e.state.is_published&&l.default.createElement("button",{className:"delete-button",onClick:function(){return e.removeQuestion(t)}},"✖"),e.state.is_live&&e.state.is_published&&l.default.createElement("button",{className:"live-button"+(e.state.settings.live_question==s?" is-live":""),onClick:function(){return e.presentLive(t)}},"L"))}),l.default.createElement("li",{key:"hidden",style:{visibility:"hidden",height:"100px"}})]:l.default.createElement("li",{style:{listStyleType:"none",textAlign:"center"}},"Drag questions here!")))}}]),t}(l.default.Component),_=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"render",value:function(){var e=this;return l.default.createElement("ol",{id:"quiz-list",className:"list"},Object.keys(this.props.quizzes).map(function(t){var s=e.props.quizzes[t];return l.default.createElement(y,{key:t,quiz:s,chooseQuiz:function(){return e.props.chooseQuiz(t)},showConfirm:e.props.showConfirm})}))}}]),t}(l.default.Component),y=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"deleteQuiz",value:function(){var e=this;this.props.showConfirm({type:"yesno",title:"Are you sure you want to delete this quiz?",onAction:function(t){t&&d.default.send("deleteQuiz",e.props.quiz._id,function(t,s){t&&e.props.showConfirm({type:"ok",title:String(t)})})}})}},{key:"render",value:function(){return l.default.createElement("li",{className:"quiz"},l.default.createElement("button",{className:"quiz-body"+(this.props.quiz.is_live?" is-live-quiz-body":""),onClick:this.props.chooseQuiz},this.props.quiz.name),l.default.createElement("button",{className:"delete-button",onClick:this.deleteQuiz.bind(this)},"✖"))}}]),t}(l.default.Component),w=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={editQuestion:null,searchTerm:"",searchTag:"",shownQuestions:e.questions},s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){this.updateShownQuestions(e.questions)}},{key:"chooseQuestion",value:function(e){this.setState({editQuestion:this.props.questions[e]})}},{key:"toggleQuestionEditor",value:function(){this.setState(function(e){return{editQuestion:e.editQuestion?null:{}}})}},{key:"hideQuestionEditor",value:function(){this.setState({editQuestion:null})}},{key:"getFolderHierarchy",value:function(){var e=[];for(var t in this.props.questions){var s=this.props.questions[t];s.tags&&s.tags.forEach(function(t){-1==e.indexOf(t)&&e.push(t)})}return[{name:this.props.user?this.props.selectedTerm.course.name:"",children:e.sort(function(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})})}]}},{key:"updateShownQuestions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.questions,t=this.state,s=t.searchTerm,n=t.searchTag;if(s||n){var i={};for(var a in e)if(!n||-1!=e[a].tags.indexOf(n)){var r=!s||-1!=e[a].title.toLowerCase().indexOf(s);r&&(i[a]=e[a])}this.setState({shownQuestions:i})}else this.setState({shownQuestions:e})}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{id:"question-panel",className:"panel home-panel"},l.default.createElement("div",{id:"question-panel-header"},l.default.createElement("button",{className:"option-button",onClick:this.toggleQuestionEditor.bind(this)},this.state.editQuestion?"Cancel":"Create Question"),!this.state.editQuestion&&l.default.createElement("div",{id:"question-search-input"},"Search:",l.default.createElement("input",{type:"text",id:"search-input",onChange:function(t){return e.setState({searchTerm:t.target.value.toLowerCase()},e.updateShownQuestions)}}))),this.state.editQuestion?l.default.createElement(E,{user:this.props.user,question:this.state.editQuestion,getResource:this.props.getResource,deleteResource:this.props.deleteResource,hideQuestionEditor:this.hideQuestionEditor.bind(this),showConfirm:this.props.showConfirm}):l.default.createElement("div",{id:"question-tags-list"},l.default.createElement(C,{tags:this.getFolderHierarchy(),searchTag:function(t){return e.setState({searchTag:t},e.updateShownQuestions)}}),l.default.createElement(z,{questions:this.state.shownQuestions,creatingQuiz:this.props.creatingQuiz,getResource:this.props.getResource,chooseQuestion:this.chooseQuestion.bind(this),showConfirm:this.props.showConfirm})))}}]),t}(l.default.Component),E=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={_id:e.question._id,title:e.question.title||"",answers:e.question.answers||["","","",""],correct:e.question.correct||0,image_id:e.question.image_id||null,tags:e.question.tags||[],tag:""},s}return r(t,e),o(t,[{key:"componentWillMount",value:function(){var e=this;this.state.image_id&&this.props.getResource(this.state.image_id,function(t,s){return!e.didUnmount&&e.setState({image:s})})}},{key:"componentWillUnmount",value:function(){this.didUnmount=!0}},{key:"changeTitle",value:function(e){this.setState({title:e.target.value})}},{key:"changeAnswer",value:function(e,t){var s=t.target.value;this.setState(function(t){var n=t.answers.slice();return n[e]=String(s),{answers:n}})}},{key:"addAnswer",value:function(){this.setState(function(e){var t=e.answers.slice();return t.push(""),{answers:t}})}},{key:"removeAnswer",value:function(e){if(2==this.state.answers.length)return void this.props.showConfirm({type:"ok",title:"You must have at least 2 answer fields."});this.setState(function(t){var s=t.answers.slice();return s.splice(e,1),{answers:s}})}},{key:"correctSelected",value:function(e){this.setState({correct:e})}},{key:"imageSelected",value:function(e){var t=this;if(e.target.files&&e.target.files[0]){var s=new FileReader;s.onload=function(e){var s=e.target.result;s.startsWith("data:image")?t.setState({image:s,image_id:null}):t.props.showConfirm({type:"ok",title:"Invalid image file"})},s.readAsDataURL(e.target.files[0])}else this.setState({image:null,image_id:null})}},{key:"clearImage",value:function(){this.setState({image:null,image_id:null})}},{key:"submitQuestion",value:function(){var e=this;if(!this.state.title.trim())return void this.props.showConfirm({type:"ok",title:"Question title cannot be empty."});var t=this.state.answers.map(function(e){return e.trim()});if(-1!=t.findIndex(function(e){return!e}))return void this.props.showConfirm({type:"ok",title:"Cannot have a blank answer field."});var s=function(t){t?e.props.showConfirm({type:"ok",title:"Error submitting question: "+t}):e.props.hideQuestionEditor()},n=function(n,i){if(n)e.props.showConfirm({type:"ok",title:"Error uploading image: "+n});else{var a={title:e.state.title,answers:t,correct:String(e.state.correct),image_id:i||null,tags:e.state.tags};e.state._id?(a._id=e.state._id,d.default.send("updateQuestion",a,s)):d.default.send("createQuestion",a,s)}};this.state.image_id?n(null,this.state.image_id):this.state.image?d.default.send("createResource",this.state.image,n):this.props.question.image_id?(d.default.send("deleteResource",this.props.question.image_id,n),this.props.deleteResource(this.props.question.image_id)):n(null,null)}},{key:"changeTag",value:function(e){this.setState({tag:e.target.value})}},{key:"addTag",value:function(){var e=this;this.state.tag&&this.setState(function(t){var s=t.tags.slice();return s.push(e.state.tag),{tags:s,tag:""}})}},{key:"removeTag",value:function(e){this.setState(function(t){var s=t.tags.slice();return s.splice(e,1),{tags:s}})}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{id:"question-creator"},l.default.createElement("label",{id:"question-creator-header"},l.default.createElement("span",{id:"question-creator-title"},"Question: "),l.default.createElement("input",{id:"question-creator-title-field",type:"text",value:this.state.title,onChange:this.changeTitle.bind(this)})),l.default.createElement("ol",{id:"question-creator-answer-list",className:"question-creator-row"},this.state.answers.map(function(t,s){return l.default.createElement("li",{key:s,className:"question-creator-answer"},l.default.createElement("input",{type:"text",value:t,size:"35",onChange:e.changeAnswer.bind(e,s)}),l.default.createElement("input",{type:"radio",name:"correct",checked:e.state.correct==s,onChange:e.correctSelected.bind(e,s)}),"Correct",l.default.createElement("button",{className:"remove-answer-button",onClick:e.removeAnswer.bind(e,s)},"✖"))})),l.default.createElement("button",{className:"question-creator-row option-button",onClick:this.addAnswer.bind(this)},"Add answer"),l.default.createElement("div",{className:"question-creator-row"},l.default.createElement("label",{className:"option-button"},"Select file",l.default.createElement("input",{type:"file",onChange:this.imageSelected.bind(this)})),this.state.image&&l.default.createElement("button",{className:"option-button clear-image-button",onClick:this.clearImage.bind(this)},"Clear image")),this.state.image&&l.default.createElement("img",{className:"question-creator-row",id:"image-input",src:this.state.image}),l.default.createElement("div",{className:"question-creator-row"},l.default.createElement("b",null,"Tags:"),l.default.createElement("ol",null,this.state.tags.map(function(t,s){return l.default.createElement("li",{key:s},e.state.tags[s],l.default.createElement("button",{className:"remove-tag-button",onClick:e.removeTag.bind(e,s)},"✖"))})),l.default.createElement("input",{type:"text",size:"15",value:this.state.tag,onChange:this.changeTag.bind(this),onKeyPress:function(t){return"Enter"===t.key&&e.addTag()}}),l.default.createElement("button",{id:"add-tag-button",className:"option-button",onClick:this.addTag.bind(this)},"Add Tag")),l.default.createElement("button",{className:"question-creator-row option-button",onClick:this.submitQuestion.bind(this)},this.state._id?"Update":"Submit"))}}]),t}(l.default.Component),z=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"deleteQuestion",value:function(e){var t=this;this.props.showConfirm({type:"yesno",title:"Are you sure you want to delete this question?",onAction:function(s){s&&d.default.send("deleteQuestion",e,function(e,s){e&&t.props.showConfirm({type:"ok",title:String(e)})})}})}},{key:"onDragStart",value:function(e,t){t.dataTransfer.setData("question-id",e)}},{key:"render",value:function(){var e=this;return l.default.createElement("ul",{id:"question-list",className:"list"},Object.keys(this.props.questions).map(function(t){return l.default.createElement(k,{key:t,question:e.props.questions[t],getResource:e.props.getResource,draggable:e.props.creatingQuiz,onDragStart:e.onDragStart.bind(e,t),initialHideAnswers:!0},l.default.createElement("button",{className:"delete-button",onClick:function(){return e.deleteQuestion(t)}},"✖"),l.default.createElement("button",{className:"edit-button",onClick:function(){return e.props.chooseQuestion(t)}},"E"))}))}}]),t}(l.default.Component),k=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={image_id:null,image:null,hideAnswers:!0},s}return r(t,e),o(t,[{key:"loadImage",value:function(e){var t=this;e?e!=this.state.image_id&&(this.setState({image_id:e}),this.props.getResource(e,function(e,s){return!t.didUnmount&&t.setState({image:s})})):this.setState({image_id:null,image:null})}},{key:"componentWillMount",value:function(){this.loadImage(this.props.question.image_id)}},{key:"componentWillReceiveProps",value:function(e){this.loadImage(e.question.image_id)}},{key:"componentWillUnmount",value:function(){this.didUnmount=!0}},{key:"toggleShowAnswers",value:function(){this.setState({hideAnswers:!this.state.hideAnswers})}},{key:"render",value:function(){var e=this;return this.props.question?l.default.createElement("li",{"data-id":this.props.question._id,className:"question"+(this.props.draggable?" draggable":"")+(this.props.draggedOver?" drag-over":""),draggable:this.props.draggable,onDragStart:this.props.onDragStart},l.default.createElement("div",{className:"question-body",style:this.state.image||this.props.question.image_id?{width:"70%"}:{}},l.default.createElement("p",{className:"question-title"},this.props.question.title),!this.state.hideAnswers&&l.default.createElement("ol",{className:"answer-list"},this.props.question.answers.map(function(t,s){return l.default.createElement("li",{key:t+s,className:"answer"},l.default.createElement("input",{type:"radio",value:s,readOnly:!0,checked:e.props.question.correct==s}),t)}))),!this.state.hideAnswers&&(this.state.image?l.default.createElement("img",{className:"question-image",src:this.state.image}):this.props.question.image_id&&l.default.createElement("p",{className:"question-image"},"Loading image")),this.props.children,l.default.createElement("button",{className:"hide-button",onClick:this.toggleShowAnswers.bind(this)},this.state.hideAnswers?"Show":"Hide")):null}}]),t}(l.default.Component),C=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={tags:s.formatTags(e.tags),selectedTag:""},s}return r(t,e),o(t,[{key:"formatTags",value:function(e){var t=this;return e.map(function(e){return"string"==typeof e?{name:e}:{name:e.name,isOpen:!0,children:t.formatTags(e.children)}})}},{key:"mergeTags",value:function(e,t){var s=this;return t.forEach(function(t){var n=e.findIndex(function(e){return e.name==t.name});if(-1!=n){var i=e[n];t.isOpen=i.isOpen,i.children&&(t.children=s.mergeTags(i.children,t.children))}}),t}},{key:"componentWillReceiveProps",value:function(e){this.setState({tags:this.mergeTags(this.state.tags,this.formatTags(e.tags))})}},{key:"recursivelyOpen",value:function(e){var t=this,s=[];return e.map(function(e,n){if(e.children&&e.children.length>0){var i=[l.default.createElement("li",{className:"parent-node tree-node",key:e.name+e.id,onClick:function(){return t.openParentNode(e)}},e.name)];e.isOpen&&(i=i.concat(t.recursivelyOpen(e.children))),s.push(l.default.createElement("ul",{key:e.name+n,className:"parent-holder"},i))}else s.push(l.default.createElement("li",{className:"leaf-node tree-node"+(t.state.selectedTag==e.name?" leaf-node-selected":""),key:e.name+e.id,onClick:function(){return t.openLeafNode(e)}},e.name))}),s}},{key:"openParentNode",value:function(e){e.isOpen=!e.isOpen,this.forceUpdate()}},{key:"openLeafNode",value:function(e){var t=this;this.setState(function(s){var n=e.name==s.selectedTag?"":e.name;return t.props.searchTag(n),{selectedTag:n}})}},{key:"render",value:function(){return l.default.createElement("ul",{id:"hierarchy-panel"},this.recursivelyOpen(this.state.tags))}}]),t}(l.default.Component)},232:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u=s(3),l=n(u),c=s(18),d=n(c),h=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={users:[],selectedUser:null},d.default.isLoggedIn()?s.getUsers():d.default.on("login",s.getUsers.bind(s)),s}return r(t,e),o(t,[{key:"getUsers",value:function(){var e=this;d.default.send("getAllUsers",function(t,s){t?console.error("Error getting users: "+t):e.setState(function(e){var t=e.selectedUser;return t&&s.findIndex(function(e){return e.username==t.username&&(t=e,!0)}),{users:s,selectedUser:t}})})}},{key:"selectUser",value:function(e){this.setState({selectedUser:e})}},{key:"render",value:function(){return l.default.createElement("div",{id:"panels"},l.default.createElement(f,{users:this.state.users,getUsers:this.getUsers.bind(this),selectUser:this.selectUser.bind(this),showConfirm:this.props.showConfirm}),l.default.createElement(p,{getUsers:this.getUsers.bind(this),selectUser:this.selectUser.bind(this),selectedUser:this.state.selectedUser,showConfirm:this.props.showConfirm}))}}]),t}(l.default.Component);t.default=h;var f=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={showStudents:!0,userToAdd:""},s}return r(t,e),o(t,[{key:"addUser",value:function(){var e=this;this.state.userToAdd&&d.default.send("addUser",this.state.userToAdd,function(t){t?e.props.showConfirm({type:"ok",title:"Error adding user: "+t}):(e.setState({userToAdd:""}),e.props.getUsers())})}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{className:"panel",id:"student-panel"},l.default.createElement("div",{id:"add-user"},l.default.createElement("input",{type:"text",value:this.state.userToAdd,onChange:function(t){return e.setState({userToAdd:t.target.value})},onSubmit:this.addUser.bind(this)}),l.default.createElement("button",{onClick:this.addUser.bind(this)},"Add user")),l.default.createElement("div",{id:"student-list"},l.default.createElement("ul",{id:"tabs"},l.default.createElement("li",null,l.default.createElement("a",{href:"#",className:"tablinks"+(this.state.showStudents?" tablinks-active":""),onClick:function(){return e.setState({showStudents:!0})}},"Students")),l.default.createElement("li",null,l.default.createElement("a",{href:"#",className:"tablinks"+(this.state.showStudents?"":" tablinks-active"),onClick:function(){return e.setState({showStudents:!1})}},"TAs"))),this.state.showStudents?l.default.createElement("div",{className:"student-list"},this.props.users.map(function(t){return(!t.permissions||!t.permissions.isTA)&&l.default.createElement("li",{key:t.username},l.default.createElement("button",{className:"list-button",onClick:function(){return e.props.selectUser(t)}},t.username))})):l.default.createElement("div",{className:"student-list"},this.props.users.map(function(t){return t.permissions&&t.permissions.isTA&&l.default.createElement("li",{key:t.username},l.default.createElement("button",{className:"list-button",onClick:function(){return e.props.selectUser(t)}},t.username))}))))}}]),t}(l.default.Component),p=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={isTA:!1,canCreateQuestions:!1,canEditQuestions:!1,canCreateQuizzes:!1,canEditQuizzes:!1,canPublishQuizzes:!1,canManageRoster:!1,canManageTAs:!1},e.selectedUser&&e.selectedUser.permissions&&(s.state.isTA=e.selectedUser.permissions.isTA,s.state.canCreateQuestions=e.selectedUser.permissions.canCreateQuestions,s.state.canEditQuestions=e.selectedUser.permissions.canEditQuestions,s.state.canCreateQuizzes=e.selectedUser.permissions.canCreateQuizzes,s.state.canEditQuizzes=e.selectedUser.permissions.canEditQuizzes,s.state.canPublishQuizzes=e.selectedUser.permissions.canPublishQuizzes,s.state.canManageRoster=e.selectedUser.permissions.canManageRoster,s.state.canManageTAs=e.selectedUser.permissions.canManageTAs),s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){e.selectedUser&&e.selectedUser.permissions&&this.setState({isTA:e.selectedUser.permissions.isTA,canCreateQuestions:e.selectedUser.permissions.canCreateQuestions,canEditQuestions:e.selectedUser.permissions.canEditQuestions,canCreateQuizzes:e.selectedUser.permissions.canCreateQuizzes,canEditQuizzes:e.selectedUser.permissions.canEditQuizzes,canPublishQuizzes:e.selectedUser.permissions.canPublishQuizzes,canManageRoster:e.selectedUser.permissions.canManageRoster,canManageTAs:e.selectedUser.permissions.canManageTAs})}},{key:"updatePermissions",value:function(){var e=this;this.props.selectedUser?d.default.send("setPermissions",{username:this.props.selectedUser.username,permissions:{isTA:!0,canCreateQuestions:this.state.canCreateQuestions,canEditQuestions:this.state.canEditQuestions,canCreateQuizzes:this.state.canCreateQuizzes,canEditQuizzes:this.state.canEditQuizzes,canPublishQuizzes:this.state.canPublishQuizzes,canManageRoster:this.state.canManageRoster,canManageTAs:this.state.canManageTAs}},function(t){e.props.getUsers(),e.props.showConfirm({type:"ok",title:t?"Could not set permissions: "+t:"Permissions updated."})}):this.props.showConfirm({type:"ok",title:"Please select a student to modify."})}},{key:"removeTA",value:function(){var e=this;this.props.selectedUser?d.default.send("setPermissions",{username:this.props.selectedUser.username,permissions:{isTA:!1,canCreateQuestions:!1,canEditQuestions:!1,canCreateQuizzes:!1,canEditQuizzes:!1,canPublishQuizzes:!1,canManageRoster:!1,canManageTAs:!1}},function(t){t?e.props.showConfirm({type:"ok",title:"Could not set permissions: "+t}):e.props.getUsers()}):this.props.showConfirm({type:"ok",title:"Please select a student to modify."})}},{key:"removeStudent",value:function(){var e=this;this.props.selectedUser&&d.default.send("removeUser",this.props.selectedUser.username,function(t){t&&e.props.showConfirm({type:"ok",title:"Error removing student: "+t}),e.props.getUsers(),e.props.selectUser(null)})}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{className:"panel",id:"permission-panel"},this.props.selectedUser?[l.default.createElement("p",{key:"title",id:"username-title"},this.props.selectedUser.username),this.state.isTA?l.default.createElement("div",{key:"permissions"},l.default.createElement("ul",{id:"permission-list"},l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canCreateQuestions,onChange:function(){return e.setState({canCreateQuestions:!e.state.canCreateQuestions})}}),l.default.createElement("div",{className:"slider"}))," Create Questions"),l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canEditQuestions,onChange:function(){return e.setState({canEditQuestions:!e.state.canEditQuestions})}}),l.default.createElement("div",{className:"slider"}))," Edit Questions"),l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canCreateQuizzes,onChange:function(){return e.setState({canCreateQuizzes:!e.state.canCreateQuizzes})}}),l.default.createElement("div",{className:"slider"}))," Create Quizzes"),l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canEditQuizzes,onChange:function(){return e.setState({canEditQuizzes:!e.state.canEditQuizzes})}}),l.default.createElement("div",{className:"slider"}))," Edit Quizzes"),l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canPublishQuizzes,onChange:function(){return e.setState({canPublishQuizzes:!e.state.canPublishQuizzes})}}),l.default.createElement("div",{className:"slider"}))," Publish Quizzes"),l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canManageRoster,onChange:function(){return e.setState({canManageRoster:!e.state.canManageRoster})}}),l.default.createElement("div",{className:"slider"}))," Manage Roster"),l.default.createElement("li",null,l.default.createElement("label",{className:"switch"},l.default.createElement("input",{type:"checkbox",checked:this.state.canManageTAs,onChange:function(){return e.setState({canManageTAs:!e.state.canManageTAs})}}),l.default.createElement("div",{className:"slider"}))," Manage TAs")),l.default.createElement("div",null,l.default.createElement("button",{className:"option-button",id:"make-ta-button",onClick:this.updatePermissions.bind(this)},"Update")),l.default.createElement("div",null,l.default.createElement("button",{className:"option-button",id:"remove-ta-button",onClick:this.removeTA.bind(this)},"Remove TA"))):l.default.createElement("div",{key:"maketa"},l.default.createElement("button",{className:"option-button",id:"make-ta-button",onClick:this.updatePermissions.bind(this)},"Make a TA")),l.default.createElement("div",{key:"removestudent"},l.default.createElement("button",{className:"option-button",id:"remove-student-button",onClick:this.removeStudent.bind(this)},"Remove Student"))]:l.default.createElement("p",null,"Please selected a user on the left panel."))}}]),t}(l.default.Component)},233:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u=s(3),l=n(u),c=s(18),d=n(c),h=s(35),f=s(73),p=n(f),m=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={showStudent:null,showQuiz:null,showAllQuizes:!1,showAllStudents:!0},s}return r(t,e),o(t,[{key:"showStudentStats",value:function(e){this.setState({showStudent:e,showQuiz:null,showAllQuizzes:!1,showAllStudents:!1})}},{key:"showQuizStats",value:function(e){this.setState({showStudent:null,showQuiz:e,showAllQuizzes:!1,showAllStudents:!1})}},{key:"showAllQuizStats",value:function(){this.setState({showStudent:null,showQuiz:null,showAllQuizzes:!0,showAllStudents:!1})}},{key:"showAllStudentStats",value:function(){this.setState({showStudent:null,showQuiz:null,showAllQuizzes:!1,showAllStudents:!0})}},{key:"render",value:function(){return l.default.createElement("div",{id:"panels"},l.default.createElement(v,{getPermissions:this.props.getPermissions,showStudentStats:this.showStudentStats.bind(this),showQuizStats:this.showQuizStats.bind(this),showAllQuizStats:this.showAllQuizStats.bind(this),showAllStudentStats:this.showAllStudentStats.bind(this),submissions:this.props.submissions}),l.default.createElement(g,{showStudent:this.state.showStudent,showQuiz:this.state.showQuiz,showAllQuizzes:this.state.showAllQuizzes,showAllStudents:this.state.showAllStudents,submissions:this.props.submissions}))}}]),t}(l.default.Component);t.default=m;var v=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={users:[],showStudents:!0},d.default.send("getAllUsers",function(e,t){if(e)console.error("Error getting users: "+e);else{var n=[];t.forEach(function(e){e.admin||e.permissions.isCreator||e.permissions.isTA||n.push(e)}),s.setState({users:n})}}),s}return r(t,e),o(t,[{key:"showStudents",value:function(){this.setState({showStudents:!0}),this.props.showAllStudentStats()}},{key:"showQuizzes",value:function(){this.setState({showStudents:!1}),this.props.showAllQuizStats()}},{key:"getAllQuizNames",value:function(){var e=this.props.submissions,t=[];for(var s in e){var n=e[s].quiz_name;-1==t.indexOf(n)&&t.push(n)}return t}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{className:"panel",id:"student-panel"},l.default.createElement("ul",{id:"tabs"},l.default.createElement("li",null,l.default.createElement("a",{href:"#",className:"tablinks"+(this.state.showStudents?" tablinks-active":""),onClick:this.showStudents.bind(this)},"Students")),l.default.createElement("li",null,l.default.createElement("a",{href:"#",className:"tablinks"+(this.state.showStudents?"":" tablinks-active"),onClick:this.showQuizzes.bind(this)},"Quizzes"))),this.state.showStudents?l.default.createElement("ul",{className:"student-list"},this.state.users.map(function(t){return l.default.createElement("li",{key:t.username},l.default.createElement("button",{className:"list-button",onClick:function(){return e.props.showStudentStats(t.username)}},t.username))})):l.default.createElement("ul",{className:"student-list"},this.getAllQuizNames().map(function(t,s){return l.default.createElement("li",{key:s+"-"+t},l.default.createElement("button",{className:"list-button",onClick:function(){return e.props.showQuizStats(t)}},t))})))}}]),t}(l.default.Component),g=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={statistics:s.getStatistics(e.submissions)},s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({statistics:this.getStatistics(e.submissions)})}},{key:"getStatistics",value:function(e){var t={};for(var s in e){var n=e[s];n.username in t||(t[n.username]={}),t[n.username][n.quiz_id]={name:n.quiz_name,answers:n.answers}}return t}},{key:"createChart",value:function(e,t){return new p.default(document.getElementById("statistics-chart"),{type:"bar",data:e,options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,max:100}}],xAxes:[{display:t}]}}})}},{key:"displayStudentStatistics",value:function(e){var t=this.state.statistics,s=[],n=[];for(var i in t[e]){var a=0,r=0;for(var o in t[e][i].answers){var u=t[e][i].answers[o];a+=u.score,r+=u.total}s.push(t[e][i].name),n.push(a/r*100)}var l={labels:s,datasets:[{label:"% correct answers",data:n,backgroundColor:"rgba(100, 129, 237, 0.5)",borderColor:"rgba(200, 200, 200, 1)",borderWidth:2}]};this.chart&&this.chart.destroy(),this.chart=this.createChart(l,!0)}},{key:"displayQuizStatistics",value:function(e){var t=this.state.statistics,s={};for(var n in t)for(var i in t[n])if(t[n][i].name==e)for(var a in t[n][i].answers){var r=t[n][i].answers[a].title,o=t[n][i].answers[a],u=s[r]||{score:0,total:0,answerScores:new Array(o.options||0).fill(0)};if(o.answer>=0){u.answerScores[o.answer]+=o.total;for(var l=0;l<u.answerScores.length;l++)u.answerScores[l]=u.answerScores[l]||0}u.score+=o.score,u.total+=o.total,s[r]=u}var c=[],d=[];for(o in s){var h=o+" ";h+=s[o].answerScores.map(function(e,t){return String.fromCharCode("A".charCodeAt(0)+t)+": "+(e/s[o].total*100).toFixed(2)+"%"}).join(" "),c.push(h),d.push(s[o].score/s[o].total*100)}var f={labels:c,datasets:[{label:"% correct answers",data:d,backgroundColor:"rgba(100, 129, 237, 0.5)",borderColor:"rgba(200, 200, 200, 1)",borderWidth:2}]};this.chart&&this.chart.destroy(),this.chart=this.createChart(f,!1)}},{key:"displayAllQuizStatistics",value:function(){var e=this.state.statistics,t={};for(var s in e)for(var n in e[s]){var i=e[s][n].name,a=0,r=0;for(var o in e[s][n].answers){var u=e[s][n].answers[o];a+=u.score,r+=u.total}null!=t[i]?(t[i].score+=a,t[i].total+=r):t[i]={score:a,total:r}}var l=[],c=[];for(var i in t)l.push(i),c.push(t[i].score/t[i].total*100);var d={labels:l,datasets:[{label:"% correct answers",data:c,backgroundColor:"rgba(100, 129, 237, 0.5)",borderColor:"rgba(200, 200, 200, 1)",borderWidth:2}]};this.chart&&this.chart.destroy(),this.chart=this.createChart(d,!0)}},{key:"displayAllStudentStatistics",value:function(){var e=this.state.statistics,t=[],s=[];for(var n in e){var i=0,a=0;for(var r in e[n]){var o=0,u=0;for(var l in e[n][r].answers){var c=e[n][r].answers[l];o+=c.score,u+=c.total}i+=o/u*100,a++}t.push((0,h.unescapeHTML)(n)),s.push(i/=a)}var d={labels:t,datasets:[{label:"% grade overall",data:s,backgroundColor:"rgba(100, 129, 237, 0.5)",borderColor:"rgba(200, 200, 200, 1)",borderWidth:2}]};this.chart&&this.chart.destroy(),this.chart=this.createChart(d,!0)}},{key:"setupChart",value:function(e){this.canvas=this.canvas||e,this.props.showStudent?this.displayStudentStatistics(this.props.showStudent):this.props.showQuiz?this.displayQuizStatistics(this.props.showQuiz):this.props.showAllQuizzes?this.displayAllQuizStatistics():this.displayAllStudentStatistics()}},{key:"render",value:function(){return l.default.createElement("div",{className:"panel",id:"statistics-panel"},l.default.createElement("canvas",{ref:this.setupChart.bind(this),id:"statistics-chart"}))}}]),t}(l.default.Component)},234:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u=s(3),l=n(u),c=s(28),d=(n(c),s(18)),h=n(d),f=s(35),p=s(71),m=(n(p),s(72),function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={selectedQuiz:null},s}return r(t,e),o(t,[{key:"chooseQuiz",value:function(e){var t=this;e&&this.state.selectedQuiz?this.props.showConfirm({type:"yesno",title:"Discard current quiz?",onAction:function(s){s&&t.setState({selectedQuiz:e})}}):this.setState({selectedQuiz:e})}},{key:"render",value:function(){var e=this;return l.default.createElement("div",{id:"panels"},l.default.createElement(v,{showConfirm:this.props.showConfirm,quizzes:this.props.quizzes,chooseQuiz:this.chooseQuiz.bind(this)}),l.default.createElement(b,{getResource:this.props.getResource,showConfirm:this.props.showConfirm,hideQuiz:function(){return e.chooseQuiz(null)},quiz:this.state.selectedQuiz&&this.props.quizzes[this.state.selectedQuiz]}))}}]),t}(l.default.Component));t.default=m;var v=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"render",value:function(){return l.default.createElement("div",{id:"quiz-panel",className:"panel home-panel"},l.default.createElement("h2",{id:"quizzes-title"},"Quizzes"),l.default.createElement(g,{quizzes:this.props.quizzes,chooseQuiz:this.props.chooseQuiz}))}}]),t}(l.default.Component),g=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"render",value:function(){var e=this;return l.default.createElement("ol",{id:"quiz-list",className:"list"},Object.keys(this.props.quizzes).map(function(t){var s=e.props.quizzes[t],n=e.props.chooseQuiz.bind(null,t);return l.default.createElement("li",{key:t,className:"quiz"},l.default.createElement("button",{className:"quiz-body"+(s.is_live?" is-live-quiz-body":""),onClick:n},(0,f.unescapeHTML)(s.name)))}))}}]),t}(l.default.Component),b=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"render",value:function(){return l.default.createElement("div",{id:"question-panel",className:"panel home-panel"},l.default.createElement("h2",{id:"quiz-title"},this.props.quiz?this.props.quiz.name:"Quiz"),this.props.quiz?l.default.createElement(_,{quiz:this.props.quiz,getResource:this.props.getResource,showConfirm:this.props.showConfirm,hideQuiz:this.props.hideQuiz}):l.default.createElement("p",{id:"choose-quiz-msg"},"Choose a quiz from the left side!"))}}]),t}(l.default.Component),_=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s._id=e.quiz._id,s.answers={},s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){e.quiz._id!=this._id&&(this.answers={})}},{key:"answerSelected",value:function(e,t){this.answers[e]=t}},{key:"submitClicked",value:function(){var e=this,t=function(){h.default.send("submitQuiz",{quiz_id:e.props.quiz._id,answers:e.answers},function(t,s){e.props.showConfirm({type:"ok",title:t?"Failed to submit, please trying again. Error: "+t:"Your answers have been submitted."}),t||(e.props.hideQuiz(),e.answers={},e._id=null)})};if(this.props.quiz.is_live)t();else{var s="Are you sure you want to submit this quiz?",n=Object.keys(this.answers).length,i=this.props.quiz.questions.length;n!=i&&(s+=" You only answered "+n+" of the "+i+" questions."),this.props.showConfirm({type:"yesno",title:s,onAction:function(e){e&&t()}})}}},{key:"render",value:function(){var e=this;return l.default.createElement("ol",{id:"question-list",className:"list"},[this.props.quiz.questions.map(function(t,s){return l.default.createElement(y,{key:s,getResource:e.props.getResource,question:t,answerSelected:e.answerSelected.bind(e,t._id)})}),l.default.createElement("li",{key:"submit-all",className:"submit-all"},l.default.createElement("button",{className:"submit-all-button",onClick:this.submitClicked.bind(this)},"Submit All"))])}}]),t}(l.default.Component),y=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={image:null},s}return r(t,e),o(t,[{key:"componentWillMount",value:function(){var e=this;this.props.question.image_id&&!this.state.image&&this.props.getResource(this.props.question.image_id,function(t,s){return e.setState({image:s})})}},{key:"answerSelected",value:function(e){this.props.answerSelected(e.target.value)}},{key:"render",value:function(){var e=this;return this.props.question?l.default.createElement("li",{className:"question"},l.default.createElement("div",{className:"question-body",style:this.state.image||this.props.question.image_id?{width:"70%"}:{}},l.default.createElement("p",{className:"question-title"},(0,f.unescapeHTML)(this.props.question.title)),l.default.createElement("ol",{className:"answer-list"},this.props.question.answers.map(function(t,s){return l.default.createElement("li",{key:t+s,className:"answer"},l.default.createElement("input",{type:"radio",name:"answers-"+e.props.question._id,value:s,onChange:e.answerSelected.bind(e)}),(0,f.unescapeHTML)(t))}))),this.state.image?l.default.createElement("img",{className:"question-image",src:this.state.image}):this.props.question.image_id&&l.default.createElement("p",{className:"question-image"},"Loading image")):null}}]),t}(l.default.Component)},236:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},u=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),l=s(3),c=n(l),d=s(28),h=n(d),f=s(18),p=n(f),m=s(235),v=n(m),g=s(231),b=n(g),_=s(233),y=n(_),w=s(232),E=n(w),z=s(234),k=n(z),C=s(71),S=n(C),q=s(72);window.onload=function(){h.default.render(c.default.createElement(q.Router,{history:q.browserHistory},c.default.createElement(q.Route,{path:"/active-learning/",component:Q},c.default.createElement(q.IndexRoute,{component:A}),c.default.createElement(q.Route,{path:"/active-learning/select-term",component:T}),c.default.createElement(q.Route,{path:"/active-learning/statistics",component:P}),c.default.createElement(q.Route,{path:"/active-learning/settings",component:j}))),document.getElementById("page"))};var Q=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={user:null,selectedTerm:null,resources:{},questions:{},quizzes:{},submissions:{},showConfirm:null},p.default.on("login",function(e){e&&(console.log("LOGIN"),console.log(e),s.setState({user:e}),e.lastSelectedTerm?(console.log("login: selecting term..."),s.selectTerm(e.lastSelectedTerm.term_id)):q.browserHistory.push("/active-learning/select-term"))}),p.default.on("user",function(e){console.log("USER"),console.log(e),s.setState(function(t){if(!v.default.isEqual(t.user,e))return console.log("user update: selecting term..."),s.selectTerm(e.lastSelectedTerm.term_id),{user:e}})}),p.default.on("questions",function(e){console.log("QUESTIONS"),console.log(e),s.setState(function(t){var s={};return Object.assign(s,t.questions),e.forEach(function(e){e.removed?delete s[e._id]:s[e._id]=e}),{questions:s}})}),p.default.on("quizzes",function(e){console.log("QUIZZES"),console.log(e),s.setState(function(t){var s={};return Object.assign(s,t.quizzes),e.forEach(function(e){e.removed?delete s[e._id]:s[e._id]=e}),{quizzes:s}})}),p.default.on("submissions",function(e){console.log("SUBMISSIONS"),console.log(e),s.setState(function(t){var s={};return Object.assign(s,t.submissions),e.forEach(function(e){s[e._id]=e}),{submissions:s}})}),p.default.connect(),s}return r(t,e),u(t,[{key:"getPermissions",value:function(){var e=this;if(this.state.user&&this.state.selectedTerm){var t=this.state.user.permissions.findIndex(function(t){return String(t.term_id)===String(e.state.selectedTerm._id)});if(-1===t)return{permissions:null,isTermAdmin:this.state.user.admin};var s=this.state.user.permissions[t];return{permissions:s,isTermAdmin:s.isCreator||s.isTA}}}},{key:"selectTerm",value:function(e){var t=this;this.setState({questions:{},quizzes:{},submissions:{}},function(){return p.default.send("selectTerm",e,function(e,s){e?(t.showConfirm({type:"ok",title:"Error selecting term: "+e}),t.setState({selectedTerm:null}),q.browserHistory.push("/active-learning/select-term")):(console.log("TERM"),console.log(s),t.setState({selectedTerm:s}))})})}},{key:"showConfirm",value:function(e){this.setState({showConfirm:e})}},{key:"hideConfirm",value:function(){this.setState({showConfirm:null})}},{key:"getResource",value:function(e,t){var s=this;this.state.resources[e]?(t&&t(null,this.state.resources[e]),this.forceUpdate()):p.default.send("getResource",e,function(n,i){n?(console.error("Failed to load image with resource id "+e+": "+n),t&&t(n)):s.setState(function(t){var s=t.resources;return s[e]=i,{resources:s}},function(){t&&t(null,i)})})}},{key:"deleteResource",value:function(e){delete this.state.resources[e]}},{key:"render",value:function(){var e=this;return c.default.createElement("div",null,(this.state.currentLiveQuiz||this.state.showConfirm)&&c.default.createElement("div",{id:"overlay"}),this.state.currentLiveQuiz&&c.default.createElement(LiveQuizPanel,{quiz:this.state.currentLiveQuiz,questions:this.state.questions,resources:this.state.resources,getResource:this.getResource.bind(this),hideLiveQuiz:this.hideLiveQuiz.bind(this)}),this.state.showConfirm&&c.default.createElement(N,o({hide:function(){return e.hideConfirm()}},this.state.showConfirm)),c.default.createElement("div",{id:"content",className:(this.state.currentLiveQuiz||this.state.showConfirm)&&"blur"},c.default.createElement(O,{user:this.state.user,selectedTerm:this.state.selectedTerm}),c.default.Children.map(this.props.children,function(t){return c.default.cloneElement(t,{user:e.state.user,getPermissions:e.getPermissions.bind(e),selectedTerm:e.state.selectedTerm,selectTerm:e.selectTerm.bind(e),questions:e.state.questions,quizzes:e.state.quizzes,submissions:e.state.submissions,getResource:e.getResource.bind(e),deleteResource:e.deleteResource.bind(e),showConfirm:e.showConfirm.bind(e)})})))}}]),t}(c.default.Component),O=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),u(t,[{key:"render",value:function(){var e=(this.props.user&&this.props.user.username?" "+this.props.user.username:"")+"!",t=this.props.selectedTerm?"\n"+this.props.selectedTerm.course.name+" - "+this.props.selectedTerm.name:"";return c.default.createElement("div",{id:"header-panel"},c.default.createElement("img",{id:"logo",src:"images/active_learning_logo_white.png",width:"175",height:"75",alt:"logo"}),c.default.createElement("div",{id:"name"},c.default.createElement("h2",null,"Welcome, ",e),c.default.createElement("h2",null,t)),c.default.createElement("form",{method:"post",style:{height:"100%"}},c.default.createElement("nav",{id:"nav-links"},c.default.createElement(q.IndexLink,{to:"/active-learning/select-term",className:"header-nav-link",activeClassName:"header-nav-link-selected"},"Change Term"),c.default.createElement(q.IndexLink,{to:"/active-learning/",className:"header-nav-link",activeClassName:"header-nav-link-selected"},"Home"),c.default.createElement(q.IndexLink,{to:"/active-learning/statistics",className:"header-nav-link",activeClassName:"header-nav-link-selected"},"Statistics"),c.default.createElement(q.IndexLink,{to:"/active-learning/settings",className:"header-nav-link",activeClassName:"header-nav-link-selected"},"Settings"),c.default.createElement("button",{className:"header-nav-link",formAction:"api/logout"},"Logout"))))}}]),t}(c.default.Component),N=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),u(t,[{key:"clicked",value:function(e){this.props.hide(),this.props.onAction&&this.props.onAction(e)}},{key:"render",value:function(){var e=this;return c.default.createElement("div",{id:"confirm-box"},c.default.createElement("p",{id:"confirm-msg"},this.props.title),c.default.createElement("div",{id:"confirm-buttons"},"yesno"==this.props.type?[c.default.createElement("button",{key:"no",onClick:function(){return e.clicked(!1)},className:"confirm-button",id:"no-button"},this.props.noText||"No"),c.default.createElement("button",{key:"ok",onClick:function(){return e.clicked(!0)},className:"confirm-button",id:"yes-button"},this.props.yesText||"Yes")]:c.default.createElement("button",{onClick:function(){return e.clicked()},className:"confirm-button",id:"ok-button"},this.props.okText||"Ok")))}}]),t}(c.default.Component),T=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));s.state={schools:[],courses:[],terms:[]};var n=function(){p.default.send("getSchools",function(t,n){t?e.showConfirm({type:"ok",title:"Error getting schools: "+t}):s.setState({schools:n})})};return p.default.isLoggedIn()?n():p.default.on("login",function(e){e.lastSelectedTerm||n()}),s}return r(t,e),u(t,[{key:"selectSchool",value:function(e){var t=this;this.state.school_id!=e&&(this.setState({selectedSchool:e,selectedCourse:null}),p.default.send("getCourses",e,function(e,s){e?t.props.showConfirm({type:"ok",title:"Error getting courses: "+e}):t.setState({courses:s,terms:[]})}))}},{key:"selectCourse",value:function(e){var t=this;this.state.course_id!=e&&(this.setState({selectedCourse:e}),p.default.send("getTerms",e,function(e,s){e?t.props.showConfirm({type:"ok",title:"Error getting terms: "+e}):t.setState({terms:s})}))}},{key:"render",value:function(){var e=this;return c.default.createElement("div",{id:"panels"},c.default.createElement("div",{className:"panel select-panel",id:"school-select-panel"},c.default.createElement("p",{className:"select-title"},"Schools"),c.default.createElement("ol",{className:"select-list"},this.state.schools.map(function(t){return c.default.createElement("li",{key:t._id},c.default.createElement("button",{className:"select-list-button"+(e.state.selectedSchool===t._id?" select-list-button-selected":""),onClick:function(){return e.selectSchool(t._id)}},t.name))}))),c.default.createElement("div",{className:"panel select-panel",id:"course-select-panel"},c.default.createElement("p",{className:"select-title"},"Courses"),c.default.createElement("ol",{className:"select-list"},this.state.courses.map(function(t){return c.default.createElement("li",{key:t._id},c.default.createElement("button",{className:"select-list-button"+(e.state.selectedCourse===t._id?" select-list-button-selected":""),onClick:function(){return e.selectCourse(t._id)}},t.name))}))),c.default.createElement("div",{className:"panel select-panel",id:"term-select-panel"},c.default.createElement("p",{className:"select-title"},"Terms"),c.default.createElement("ol",{className:"select-list"},this.state.terms.map(function(t){return c.default.createElement("li",{key:t._id},c.default.createElement("button",{className:"select-list-button",onClick:function(){return e.props.selectTerm(t._id)||q.browserHistory.push("/active-learning/")}},t.name))}))))}}]),t}(c.default.Component),A=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),u(t,[{key:"render",value:function(){var e=this.props.getPermissions();return e?e.isTermAdmin?c.default.createElement(b.default,this.props):c.default.createElement(k.default,this.props):c.default.createElement("div",null,"Logging in...")}}]),t}(c.default.Component),P=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),u(t,[{key:"render",value:function(){var e=this.props.getPermissions();return e?e.isTermAdmin?c.default.createElement(y.default,this.props):c.default.createElement(S.default,this.props):c.default.createElement("div",null,"Logging in...")}}]),t}(c.default.Component),j=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),u(t,[{key:"render",value:function(){var e=this.props.getPermissions();return e?e.isTermAdmin?c.default.createElement(E.default,this.props):c.default.createElement("div",null,"Unimplemented."):c.default.createElement("div",null,"Logging in...")}}]),t}(c.default.Component)},35:function(e,t,s){"use strict";function n(e){if(null==e)return"";for(var t;(t=decodeURIComponent(e).replace(r,function(e){return a[e]}))!=e;)e=t;return e}function i(e){for(var t=e+"=",s=document.cookie.split(";"),n=0;n<s.length;n++){var i=s[n].trim();if(0==i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeHTML=n,t.readCookie=i;var a={"&apos;":"'","&#39;":"'","&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'},r=new RegExp("("+Object.keys(a).join("|")+")","g")},71:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u=s(3),l=n(u),c=s(18),d=(n(c),s(35)),h=s(73),f=n(h),p=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"render",value:function(){return l.default.createElement("div",{id:"panels"},l.default.createElement(m,{submissions:this.props.submissions}))}}]),t}(l.default.Component);t.default=p;var m=function(e){function t(e){i(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.state={statistics:s.getStatistics(e.submissions)},s}return r(t,e),o(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({statistics:this.getStatistics(e.submissions)})}},{key:"getStatistics",value:function(e){var t={};for(var s in e){var n=e[s];t[n.quiz_id]={name:n.quiz_name,answers:n.answers}}return t}},{key:"setupChart",value:function(e){this.canvas=this.canvas||e;var t=this.state.statistics,s=[],n=[];for(var i in t){var a=0,r=0;for(var o in t[i].answers){var u=t[i].answers[o];a+=u.score,r+=u.total}s.push((0,d.unescapeHTML)(t[i].name)),n.push(a/r*100)}var l={labels:s,datasets:[{label:"% correct answers",data:n,backgroundColor:"rgba(100, 129, 237, 0.5)",borderColor:"rgba(200, 200, 200, 1)",borderWidth:2}]};this.chart&&this.chart.destroy(),this.chart=new f.default(this.canvas,{type:"bar",data:l,options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,max:100}}]}}})}},{key:"render",value:function(){return l.default.createElement("div",{id:"student-statistics-panel",className:"panel"},l.default.createElement("canvas",{ref:this.setupChart.bind(this),id:"statistics-chart"}))}}]),t}(l.default.Component)}},[236]);